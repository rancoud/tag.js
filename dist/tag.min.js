/**
 * tag.js (v1.0.0)
 * https://github.com/rancoud/tag.js
 * 
 * MIT License
 * 
 * Copyright (c) 2023 Rancoud
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
!function(){"use strict";function e(e,t){var n,a,s,i,o=0,r={inputObj:null,textareaObj:null,listObj:null,newObj:null,ariaLabel:"",srSpeakAdd:"",srSpeakDelete:"",itemClass:"",liClass:"",keys:null,events:null,speakFn:null},l=[{name:"data-tag-form-input-id",optionName:"inputObj"},{name:"data-tag-form-textarea-id",optionName:"textareaObj"},{name:"data-tag-list-id",optionName:"listObj"},{name:"data-tag-new-id",optionName:"newObj"}],p=[{name:"data-tag-aria-label",defaultValue:"Remove %s from the list",optionName:"ariaLabel"},{name:"data-tag-srspeak-add",defaultValue:"%s added",optionName:"srSpeakAdd"},{name:"data-tag-srspeak-delete",defaultValue:"%s deleted",optionName:"srSpeakDelete"}];if(!(e instanceof HTMLElement))return Error("error");for(n=l.length;o<n;++o){if(s=l[o].name,!((s="string"!=typeof(i=e.getAttribute(l[o].name)||null)?new TypeError("Invalid attribute "+s+", expect string, get "+typeof i):document.getElementById(i)||new Error("DOM element "+i+" not found"))instanceof HTMLElement))return s;r[l[o].optionName]=s}for(o=0,n=p.length;o<n;++o){if(-1===(a=e.getAttribute(p[o].name)||p[o].defaultValue).indexOf("%s"))return new Error("Attribute "+p[o].name+' missing "%s"');r[p[o].optionName]=a}if(r.itemClass=e.getAttribute("data-tag-item-class")||"",r.liClass=e.getAttribute("data-tag-li-class")||"",a=e.getAttribute("data-tag-new-keys")||",",r.keys=a.split("|"),"function"==typeof t)r.speakFn=t;else if(void 0!==t)return new Error;new d(0,r)}function d(e,t){this.options=t,this.options.events={keypress:this.tryToAddTagOnKeypress.bind(this),click:this.tryToDeleteTag.bind(this)},this.options.inputObj.addEventListener("keypress",this.options.events.keypress),this.options.listObj.addEventListener("click",this.options.events.click)}d.prototype.tryToAddTagOnKeypress=function(e){for(var t=0,n=this.options.keys.length;t<n;++t)if(this.options.keys[t]===e.key){this.add(e.target.value.trim()),e.target.value="",e.preventDefault();break}},d.prototype.tryToDeleteTag=function(e){var t;e.preventDefault(),null!==(t=e.target.closest("button"))&&this.remove(t.parentElement,t.textContent)},d.prototype.add=function(e){var t,n,a,s=document.createTextNode(e);""!==s.textContent&&((t=document.createElement("li")).setAttribute("class",this.options.liClass),(n=document.createElement("span")).classList.add("sr-only"),n.appendChild(document.createTextNode(e)),(a=document.createElement("button")).setAttribute("aria-label",this.options.ariaLabel.replace("%s",s.textContent)),a.setAttribute("class",this.options.itemClass),a.appendChild(document.createTextNode(e)),t.appendChild(n),t.appendChild(a),this.options.listObj.insertBefore(t,this.options.newObj),null!==this.options.speakFn&&this.options.speakFn.call(window,this.options.srSpeakAdd.replace("%s",s.textContent)),this.refreshTextarea())},d.prototype.remove=function(e,t){var n=document.createTextNode(t);e.remove(),null!==this.options.speakFn&&this.options.speakFn.call(window,this.options.srSpeakDelete.replace("%s",n.textContent)),this.refreshTextarea()},d.prototype.refreshTextarea=function(){for(var e=[],t=this.options.listObj.querySelectorAll(".sr-only"),n=0,a=t.length;n<a;++n)e.push(t[n].textContent);this.options.textareaObj.value=e.join("\n")},Object.freeze(e.prototype),Object.freeze(e),window.Tag=e}();